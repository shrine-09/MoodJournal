@inherits LayoutComponentBase
@inject IJSRuntime JS

<div class="app-shell">
    <aside class="sidebar">
        <div class="brand">
            <div class="logo"></div>
            <div>
                <div class="brand-title">MoodJournal</div>
                <div class="brand-subtitle">Daily tracker</div>
            </div>
        </div>

        <NavMenu />

        <div class="sidebar-footer">
            Local • Private • Offline
        </div>
    </aside>

    <div class="main">
        <header class="topbar">
            <div class="page-title">MoodJournal</div>

            <button class="icon-btn" title="Toggle theme" @onclick="ToggleThemeSafe" disabled="@_toggling">
                🌙
            </button>
        </header>

        <main class="content">
            @Body
        </main>
    </div>
</div>

@code {
    private bool _toggling;

    private async Task ToggleThemeSafe()
    {
        if (_toggling) return;
        _toggling = true;

        try
        {
            await JS.InvokeVoidAsync("toggleTheme");
        }
        catch
        {
            //if JS not available, don't freeze the app
        }
        finally
        {
            _toggling = false;
        }
    }
}